from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram.utils.keyboard import InlineKeyboardBuilder

def get_main_menu_keyboard(is_admin: bool = False, is_linked: bool = True) -> InlineKeyboardMarkup:
    """Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ"""
    builder = InlineKeyboardBuilder()
    builder.button(text="ğŸ“‹ ĞœĞ¾Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸", callback_data="my_tasks")
    builder.button(text="ğŸ“ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ", callback_data="create_task")
    builder.button(text="ğŸ“Š Ğ—Ğ°ĞºĞ°Ğ·Ñ‹", callback_data="orders")
    builder.button(text="â• Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ·", callback_data="create_order")
    builder.button(text="ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ", callback_data="profile")
    builder.button(text="â­ Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³", callback_data="rating")
    builder.button(text="ğŸ’¬ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ", callback_data="messages")
    builder.button(text="âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸", callback_data="settings")

    # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ¸ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° Ğ´Ğ»Ñ Ğ½ĞµĞ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
    if not is_linked:
        builder.button(text="ğŸ”— ĞŸÑ€Ğ¸Ğ²ÑĞ·Ğ°Ñ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚", callback_data="link_account")

    # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ°Ğ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²
    if is_admin:
        builder.button(text="ğŸ”§ ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ", callback_data="admin")

    builder.adjust(2)
    return builder.as_markup()

def get_task_actions_keyboard(task_id: int = None) -> InlineKeyboardMarkup:
    """Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡ĞµĞ¹"""
    builder = InlineKeyboardBuilder()
    if task_id:
        builder.button(text="âœï¸ Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ", callback_data=f"edit_task_{task_id}")
        builder.button(text="ğŸ—‘ï¸ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ", callback_data=f"delete_task_{task_id}")
        builder.button(text="âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ", callback_data=f"complete_task_{task_id}")
        builder.button(text="ğŸ‘¤ ĞĞ°Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ÑŒ", callback_data=f"assign_task_{task_id}")
        builder.button(text="ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", callback_data="back_to_tasks")
    else:
        builder.button(text="ğŸ“‹ ĞœĞ¾Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸", callback_data="my_tasks")
        builder.button(text="ğŸ“ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ", callback_data="create_task")
        builder.button(text="ğŸ”™ Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ", callback_data="main_menu")
    builder.adjust(2, 1)
    return builder.as_markup()

def get_order_actions_keyboard(order_id: int) -> InlineKeyboardMarkup:
    """Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ¼"""
    builder = InlineKeyboardBuilder()
    builder.button(text="âœï¸ Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ", callback_data=f"edit_order_{order_id}")
    builder.button(text="ğŸ—‘ï¸ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ", callback_data=f"delete_order_{order_id}")
    builder.button(text="âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ", callback_data=f"complete_order_{order_id}")
    builder.button(text="ğŸ’¼ ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ", callback_data=f"order_proposals_{order_id}")
    builder.button(text="ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", callback_data="back_to_orders")
    builder.adjust(2)
    return builder.as_markup()

def get_profile_keyboard() -> InlineKeyboardMarkup:
    """ĞœĞµĞ½Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ"""
    builder = InlineKeyboardBuilder()
    builder.button(text="âœï¸ Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ", callback_data="edit_profile")
    builder.button(text="ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°", callback_data="statistics")
    builder.button(text="â­ ĞœĞ¾Ğ¸ Ğ¾Ñ‚Ğ·Ñ‹Ğ²Ñ‹", callback_data="my_reviews")
    builder.button(text="ğŸ”— ĞŸÑ€Ğ¸Ğ²ÑĞ·Ğ°Ñ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚", callback_data="link_account")
    builder.button(text="ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", callback_data="back_to_main")
    builder.adjust(1)
    return builder.as_markup()

def get_settings_keyboard() -> InlineKeyboardMarkup:
    """ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸"""
    builder = InlineKeyboardBuilder()
    builder.button(text="ğŸ”” Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ", callback_data="notification_settings")
    builder.button(text="ğŸŒ Ğ¯Ğ·Ñ‹Ğº", callback_data="language_settings")
    builder.button(text="ğŸ”’ ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ", callback_data="privacy_settings")
    builder.button(text="ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", callback_data="back_to_main")
    builder.adjust(1)
    return builder.as_markup()

def get_priority_keyboard() -> InlineKeyboardMarkup:
    """Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ°"""
    builder = InlineKeyboardBuilder()
    builder.button(text="ğŸŸ¢ ĞĞ¸Ğ·ĞºĞ¸Ğ¹ (1)", callback_data="priority_1")
    builder.button(text="ğŸŸ¡ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ (2)", callback_data="priority_2")
    builder.button(text="ğŸŸ  Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ (3)", callback_data="priority_3")
    builder.button(text="ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ (4)", callback_data="priority_4")
    builder.adjust(2)
    return builder.as_markup()

def get_confirmation_keyboard(action: str, item_id: int = None) -> InlineKeyboardMarkup:
    """ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ"""
    builder = InlineKeyboardBuilder()
    if item_id:
        builder.button(text="âœ… Ğ”Ğ°", callback_data=f"confirm_{action}_{item_id}")
        builder.button(text="âŒ ĞĞµÑ‚", callback_data=f"cancel_{action}_{item_id}")
    else:
        builder.button(text="âœ… ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ", callback_data=f"confirm_{action}")
        builder.button(text="âŒ ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ", callback_data=f"cancel_{action}")
    builder.adjust(2)
    return builder.as_markup()

def get_pagination_keyboard(page: int, total_pages: int, action: str) -> InlineKeyboardMarkup:
    """ĞŸĞ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ"""
    builder = InlineKeyboardBuilder()
    
    if page > 1:
        builder.button(text="â¬…ï¸", callback_data=f"{action}_page_{page-1}")
    
    builder.button(text=f"{page}/{total_pages}", callback_data="current_page")
    
    if page < total_pages:
        builder.button(text="â¡ï¸", callback_data=f"{action}_page_{page+1}")
    
    builder.button(text="ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´", callback_data=f"back_to_{action}")
    builder.adjust(3, 1)
    return builder.as_markup() 